<!DOCTYPE html><html lang="zh-Hant"><head>
<meta charset="utf-8"><meta name="viewport" content="width=device-width,initial-scale=1">
<title>發音練習</title><link rel="manifest" href="manifest.json"><link rel="stylesheet" href="styles.css"></head><body>
<header class='appbar'><div class='bar'><h1 class='title'>發 音 練 習</h1></div></header>
<div class="appbar"><div class="row" style="justify-content:center;gap:12px">
  <button id="btnV" class="pill teal">母 音</button>
  <button id="btnC" class="pill">子 音</button>
  <select id="speedSel" class="pill amber select">
    <option value="0.5">x0.5</option>
    <option value="0.75" selected>x0.75</option>
    <option value="1">x1</option>
  </select>
  <span id="mickey" class="pill"><svg viewBox='0 0 24 24' aria-hidden='true'><circle cx='12' cy='12' r='6' stroke='currentColor' fill='none' stroke-width='2'/><circle cx='6' cy='6' r='3' stroke='currentColor' fill='none' stroke-width='2'/><circle cx='18' cy='6' r='3' stroke='currentColor' fill='none' stroke-width='2'/></svg></span>
</div></div>
<main class="wrap">
  <div id="gridV" class="grid"></div>
  <div id="gridC" class="grid" style="display:none"></div>
  <div class="note">더블 탭하면 단어 연습 · 點兩下有單字練習</div>
</main>

    <nav class="tabbar"><div class="in">
      <a class='active' href='index.html'><span class='ico'><svg viewBox='0 0 24 24' aria-hidden='true'><circle cx='12' cy='12' r='10' stroke='currentColor' fill='none' stroke-width='2'/></svg></span>發音練習</a>
      <a class='' href='travel.html'><span class='ico'><svg viewBox='0 0 24 24' aria-hidden='true'><rect x='4' y='4' width='16' height='16' stroke='currentColor' fill='none' stroke-width='2'/></svg></span>旅行會話</a>
      <a class='' href='translate.html'><span class='ico'><svg viewBox='0 0 24 24' aria-hidden='true'><path d='M21 21l-4.3-4.3M11 19a8 8 0 1 1 0-16 8 8 0 0 1 0 16z' stroke='currentColor' fill='none' stroke-width='2'/></svg></span>實時翻譯</a>
      <a class='' href='history.html'><span class='ico'><svg viewBox='0 0 24 24' aria-hidden='true'><circle cx='12' cy='12' r='9' stroke='currentColor' fill='none' stroke-width='2'/><path d='M12 7v5l3 3' stroke='currentColor' fill='none' stroke-width='2'/></svg></span>歷史紀錄</a>
    </div></nav>
    
<section class="modal" id="detail"><div class="sheet">
  <div style="display:flex;align-items:center;gap:12px">
    <button class="backbtn" id="back"><svg width="22" height="22" viewBox="0 0 24 24" fill="none" stroke="#fff" stroke-width="3" stroke-linecap="round" stroke-linejoin="round"><path d="M15 18l-6-6 6-6"/></svg></button>
    <h3 class="title" style="flex:1;text-align:center;letter-spacing:6px;color:#78bfc0;margin:0">發 音 練 習</h3>
    <select id="speedSel2" class="pill amber select"><option value="0.5">x0.5</option><option value="0.75" selected>x0.75</option><option value="1">x1</option></select>
  </div>
  <div class="big"><span id="bigSym">ㅏ</span></div>
  <div id="words"></div>
</div></section>
<script>
// ---- shared state ----
let rate = parseFloat(localStorage.getItem('rate')||'0.75');
let cartoon = localStorage.getItem('cartoon')==='1';
const setRateSel = () => {
  document.getElementById('speedSel').value = String(rate);
  document.getElementById('speedSel2').value = String(rate);
};

// ---- TTS helpers ----
function speak(text, lang='ko-KR') {
  const u = new SpeechSynthesisUtterance(text);
  u.lang = lang;
  u.rate = rate;
  if (lang.startsWith('en')) { u.pitch = cartoon ? 1.6 : 1.0; }
  const vs = speechSynthesis.getVoices();
  if(lang.startsWith('ko')) {
    const v=vs.find(v=>/ko/i.test(v.lang||'')); if(v) u.voice=v;
  }
  speechSynthesis.cancel(); // stop previous to avoid overlap
  speechSynthesis.speak(u);
}

// ---- DATA ----
const DATA = {
  vowels: [{"sym": "ㅏ", "roman": "a", "say": "아", "words": [["아기", "嬰兒", "a-gi"], ["사과", "蘋果", "sa-gwa"]]}, {"sym": "ㅑ", "roman": "ya", "say": "야", "words": [["야구", "棒球", "ya-gu"]]}, {"sym": "ㅓ", "roman": "eo", "say": "어", "words": [["서울", "首爾", "seo-ul"]]}, {"sym": "ㅕ", "roman": "yeo", "say": "여", "words": [["여름", "夏天", "yeo-reum"]]}, {"sym": "ㅗ", "roman": "o", "say": "오", "words": [["오빠", "哥哥", "oppa"]]}, {"sym": "ㅛ", "roman": "yo", "say": "요", "words": [["요가", "瑜伽", "yo-ga"]]}, {"sym": "ㅜ", "roman": "u", "say": "우", "words": [["우리", "我們", "u-ri"]]}, {"sym": "ㅠ", "roman": "yu", "say": "유", "words": [["유리", "玻璃", "yu-ri"]]}, {"sym": "ㅡ", "roman": "eu", "say": "으", "words": [["으악", "啊", "eu-ak"]]}, {"sym": "ㅣ", "roman": "i", "say": "이", "words": [["이름", "名字", "i-reum"]]}, {"sym": "ㅐ", "roman": "ae", "say": "애", "words": [["애기", "孩子", "ae-gi"]]}, {"sym": "ㅒ", "roman": "yae", "say": "얘", "words": [["얘기", "聊天", "yae-gi"]]}, {"sym": "ㅔ", "roman": "e", "say": "에", "words": [["에어컨", "冷氣", "e-eo-kon"]]}, {"sym": "ㅖ", "roman": "ye", "say": "예", "words": [["예술", "藝術", "ye-sul"]]}, {"sym": "ㅘ", "roman": "wa", "say": "와", "words": [["사과", "蘋果", "sa-gwa"]]}, {"sym": "ㅙ", "roman": "wae", "say": "왜", "words": [["왜", "為什麼", "wae"]]}, {"sym": "ㅚ", "roman": "oe", "say": "외", "words": [["외국", "外國", "oe-guk"]]}, {"sym": "ㅝ", "roman": "wo", "say": "워", "words": [["원", "圓/韓元", "won"]]}, {"sym": "ㅞ", "roman": "we", "say": "웨", "words": [["웨딩", "婚禮", "we-ding"]]}, {"sym": "ㅟ", "roman": "wi", "say": "위", "words": [["위험", "危險", "wi-heom"]]}, {"sym": "ㅢ", "roman": "ui", "say": "의", "words": [["의사", "醫生", "ui-sa"]]}],
  consonants: [{"sym": "ㄱ", "roman": "g", "say": "가", "words": [["가다", "去", "ga-da"]]}, {"sym": "ㄲ", "roman": "kk", "say": "까", "words": [["까치", "喜鵲", "kka-chi"]]}, {"sym": "ㄴ", "roman": "n", "say": "나", "words": [["나무", "樹", "na-mu"]]}, {"sym": "ㄷ", "roman": "d", "say": "다", "words": [["다리", "橋", "da-ri"]]}, {"sym": "ㄸ", "roman": "tt", "say": "따", "words": [["딸기", "草莓", "ttal-gi"]]}, {"sym": "ㄹ", "roman": "r/l", "say": "라", "words": [["라면", "泡麵", "ra-myeon"]]}, {"sym": "ㅁ", "roman": "m", "say": "마", "words": [["마음", "心", "ma-eum"]]}, {"sym": "ㅂ", "roman": "b", "say": "바", "words": [["바다", "海", "ba-da"]]}, {"sym": "ㅃ", "roman": "pp", "say": "빠", "words": [["빵", "麵包", "ppang"]]}, {"sym": "ㅅ", "roman": "s", "say": "사", "words": [["사람", "人", "sa-ram"]]}, {"sym": "ㅆ", "roman": "ss", "say": "싸", "words": [["쌀", "米", "ssal"]]}, {"sym": "ㅇ", "roman": "ng/∅", "say": "아", "words": [["아이", "孩子", "a-i"]]}, {"sym": "ㅈ", "roman": "j", "say": "자", "words": [["자전거", "腳踏車", "ja-jeon-geo"]]}, {"sym": "ㅉ", "roman": "jj", "say": "짜", "words": [["짜장면", "炸醬麵", "jja-jang-myeon"]]}, {"sym": "ㅊ", "roman": "ch", "say": "차", "words": [["차", "車", "cha"]]}, {"sym": "ㅋ", "roman": "k", "say": "카", "words": [["카페", "咖啡館", "ka-pe"]]}, {"sym": "ㅌ", "roman": "t", "say": "타", "words": [["타다", "搭乘", "ta-da"]]}, {"sym": "ㅍ", "roman": "p", "say": "파", "words": [["파도", "海浪", "pa-do"]]}, {"sym": "ㅎ", "roman": "h", "say": "하", "words": [["한국", "韓國", "han-guk"]]}]
};

// ---- UI builders ----
function tile(it) {
  const el = document.createElement('div');
  el.className = 'tile';
  el.innerHTML = `<div class='sym'>${it.sym}</div><div class='rom'>${it.roman}</div>`;
  el.addEventListener('click',()=>speak(it.say,'ko-KR'));
  el.addEventListener('dblclick',(ev)=>{ev.stopPropagation();openDetail(it);});
  return el;
}
function render() {
  const gv=document.getElementById('gridV'); gv.innerHTML='';
  DATA.vowels.forEach(it=>gv.appendChild(tile(it)));
  const gc=document.getElementById('gridC'); gc.innerHTML='';
  DATA.consonants.forEach(it=>gc.appendChild(tile(it)));
}
function openDetail(item){
  document.getElementById('bigSym').textContent=item.sym;
  const w=document.getElementById('words'); w.innerHTML='';
  item.words.forEach(([ko,zh,rom])=>{
    const d=document.createElement('div'); d.className='word';
    d.innerHTML=`<div class='ko'>${ko}</div>
      <div><div class='zh'>${zh}</div><div class='desc'>${rom}</div></div>
      <div class='playbtn' data-say='${ko}' aria-label='play'>
        <svg viewBox='0 0 24 24' width='14' height='14'><polygon points='8,5 19,12 8,19'/></svg>
      </div>`;
    w.appendChild(d);
  });
  document.getElementById('detail').style.display='block';
}
// delegate click for play buttons
document.addEventListener('click',e=>{
  const btn = e.target.closest('.playbtn');
  if(btn) { const t = btn.getAttribute('data-say'); if(t) speak(t,'ko-KR'); }
});

// ---- tab buttons ----
const btnV=document.getElementById('btnV'), btnC=document.getElementById('btnC');
btnV.addEventListener('click',()=>{btnV.classList.add('teal');btnC.classList.remove('teal');document.getElementById('gridV').style.display='grid';document.getElementById('gridC').style.display='none';});
btnC.addEventListener('click',()=>{btnC.classList.add('teal');btnV.classList.remove('teal');document.getElementById('gridC').style.display='grid';document.getElementById('gridV').style.display='none';});

// ---- speed & mickey ----
document.getElementById('speedSel').addEventListener('change',()=>{rate=parseFloat(speedSel.value);localStorage.setItem('rate',rate);setRateSel();});
document.getElementById('speedSel2').addEventListener('change',()=>{rate=parseFloat(speedSel2.value);localStorage.setItem('rate',rate);setRateSel();});
const micky = document.getElementById('mickey'); if(cartoon) micky.classList.add('teal');
micky.addEventListener('click',()=>{cartoon=!cartoon;localStorage.setItem('cartoon',cartoon?'1':'0');micky.classList.toggle('teal',cartoon);});
document.getElementById('back').addEventListener('click',()=>document.getElementById('detail').style.display='none');

// init
render(); setRateSel();
</script>
</body></html>
